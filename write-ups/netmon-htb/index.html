<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="https://app.hackthebox.com/machines/Netmon
Recon and User Flag First, we start with a nmap scan and discover that ports 21, 80, 139, 445 and 5985 are open.
Next, we perform nmap with default scripts and service detection flags on those ports.
As FTP is open, we connect to it with Anonymous login and see that we have an entire Windows Machine to explore in it. Going directly to the Public User we already get our user flag." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://b1d0ws.github.io/write-ups/netmon-htb/" />


    <title>
        
            Netmon - HackTheBox :: b1d0ws 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Netmon - HackTheBox">
<meta itemprop="description" content="https://app.hackthebox.com/machines/Netmon
Recon and User Flag First, we start with a nmap scan and discover that ports 21, 80, 139, 445 and 5985 are open.
Next, we perform nmap with default scripts and service detection flags on those ports.
As FTP is open, we connect to it with Anonymous login and see that we have an entire Windows Machine to explore in it. Going directly to the Public User we already get our user flag."><meta itemprop="datePublished" content="2022-07-22T14:30:50-03:00" />
<meta itemprop="dateModified" content="2022-07-22T14:30:50-03:00" />
<meta itemprop="wordCount" content="280"><meta itemprop="image" content="https://b1d0ws.github.io/"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://b1d0ws.github.io/"/>

<meta name="twitter:title" content="Netmon - HackTheBox"/>
<meta name="twitter:description" content="https://app.hackthebox.com/machines/Netmon
Recon and User Flag First, we start with a nmap scan and discover that ports 21, 80, 139, 445 and 5985 are open.
Next, we perform nmap with default scripts and service detection flags on those ports.
As FTP is open, we connect to it with Anonymous login and see that we have an entire Windows Machine to explore in it. Going directly to the Public User we already get our user flag."/>




    <meta property="og:title" content="Netmon - HackTheBox" />
<meta property="og:description" content="https://app.hackthebox.com/machines/Netmon
Recon and User Flag First, we start with a nmap scan and discover that ports 21, 80, 139, 445 and 5985 are open.
Next, we perform nmap with default scripts and service detection flags on those ports.
As FTP is open, we connect to it with Anonymous login and see that we have an entire Windows Machine to explore in it. Going directly to the Public User we already get our user flag." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://b1d0ws.github.io/write-ups/netmon-htb/" /><meta property="og:image" content="https://b1d0ws.github.io/"/><meta property="article:section" content="write-ups" />
<meta property="article:published_time" content="2022-07-22T14:30:50-03:00" />
<meta property="article:modified_time" content="2022-07-22T14:30:50-03:00" /><meta property="og:site_name" content="b1d0ws" />







    <meta property="article:published_time" content="2022-07-22 14:30:50 -0300 -03" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark"> </span>
            <span class="logo__text">/home/b1d0ws</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/certifications/">certifications</a></li><li><a href="/posts/">posts</a></li><li><a href="/write-ups/">write-ups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://b1d0ws.github.io/write-ups/netmon-htb/">Netmon - HackTheBox</a></h2>

            
            
            

            <div class="post-content">
                <p><a href="https://app.hackthebox.com/machines/Netmon">https://app.hackthebox.com/machines/Netmon</a></p>
<p><img src="/netmon/bannerNetmon.png" alt="netmon-banner"></p>
<h2 id="recon-and-user-flag"><strong>Recon and User Flag</strong></h2>
<p>First, we start with a nmap scan and discover that <em>ports 21, 80, 139, 445 and 5985 are open.</em></p>
<p>Next, we perform nmap with default scripts and service detection flags on those ports.</p>
<p><img src="/netmon/nmap.png" alt="netmon-nmap"></p>
<p><br>
As FTP is open, we connect to it with <em>Anonymous login</em> and see that we have an entire Windows Machine to explore in it. Going directly to the Public User we already get our <em>user flag.</em></p>
<p>I think this is the easiest user flag that exists in HTB.</p>
<p><img src="/netmon/userFlag.png" alt="netmon-userFlag"></p>
<h2 id="root-flag"><strong>Root Flag</strong></h2>
<p>Going to the website, we find a <em>PTRG Network Monitor</em> login page. Now we need to find the credentials of it.</p>
<p>The default credentials <em>prtgadmin:prtgadmin</em> doesn’t work here.</p>
<p><img src="/netmon/httpSite.png" alt="netmon-httpSite"></p>
<p><br>
Searching in google about PRTG Admin, we discover where it stores its data and files.</p>
<p><img src="/netmon/prtgSearching.png" alt="netmon-search"></p>
<p><br>
In this directory we find some interesting files, specific the <em>PRTG Configuration.old.bak</em> file.</p>
<p>OBS: the “ProgramData” folder sometimes is hidden in Windows.</p>
<p><img src="/netmon/gettingPrtgConfig.png" alt="netmon-config"></p>
<p><br>
Analyzing this file, we maybe find the <em>credentials</em> we need.</p>
<p><img src="/netmon/credentials.png" alt="netmon-credentials"></p>
<p><br>
Using these credentials to login in PRTG Panel or in SMB does not work.</p>
<p>Here we need to understand the structure of the password and change 2018 to 2019, since the credentials we found is in a old file from 2018 and there is another config file created in 2019.</p>
<p>So using <em>prtgadmin:PrTg@admin2019</em> works in the PRTG Panel.</p>
<p><img src="/netmon/prtgAdminPanel.png" alt="netmon-admin"></p>
<p><br>
Looking for PRTG vulnerability we find a <em>Remote Code Execution (Authenticated)</em> exploit that can be used.</p>
<p><img src="/netmon/searchsploit.png" alt="netmon-searchsploit"></p>
<p><br>
We just need to insert the <em>session cookies</em> to authenticate our exploit in command line and the exploit creates a user with administrator privilege for us.</p>
<p><img src="/netmon/exploit.png" alt="netmon-exploit"></p>
<p><br>
After that, we can just log in with <em>evil-winrm</em> and get the <em>root flag.</em>
<img src="/netmon/rootFlag.png" alt="netmon-rootFlag"></p>
<p>See ya =).</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.cf7fb2a9e24608a783e05e4472da2fdf008293289de1ad88d1cba5c143e7e414496dd33b6a228e92f8461ce0c8cbad3c9f9847e73e46dfbce0463393ddd1733a.js" integrity="sha512-z3&#43;yqeJGCKeD4F5Ectov3wCCkyid4a2I0culwUPn5BRJbdM7aiKOkvhGHODIy608n5hH5z5G37zgRjOT3dFzOg=="></script>



    </body>
</html>
